# 🎵 xiaosongshu

> **本项目是基于 ai 协助开发的实验性产物。**
>
> 这是一个轻量级、高颜值的 FNOS 本地音乐播放器，基于 Flask + 原生 Web 技术构建。

🚧 **目前项目处于早期开发阶段，功能暂不稳定，欢迎提交 PR 完善项目 或 Issue 反馈 Bug！**

---

## ✨ 核心功能

*   **🎧 本地音乐库**
    *   自动扫描并管理上传的音乐文件。
    *   支持识别 ID3 内嵌元数据（支持封面、歌词）。
    *   播放时支持通过 LrcApi 获取封面、歌词。
*   **📱 沉浸式播放器**
    *   **响应式 UI**：完美适配 PC Web端，提供原生 App 般的流畅体验。
    *   **动态视觉**：支持歌词滚动显示、根据封面自动提取主题色。
*   **📂 灵活目录管理**
    *   支持添加服务器上的任意文件夹到音乐库，无需重复移动文件。
*   **☁️ 网易云音乐集成**
    *   集成搜索、高品质下载功能。
    *   支持链接解析及扫码登录，轻松同步歌单。
*   **🔊 音频预览**
    *   支持右键快速预览播放音频文件（需安装 xiaosongshu Preview 扩展）。

## 🚀 快速开始

### 1. 启动服务

```bash
python app/server/app.py --music-library-path ./Music --log-path ./app.log --port 28999
```

参数：
- `--music-library-path`: 音乐文件存储目录
- `--log-path`: 日志文件路径
- `--port`: 服务端口 (默认 28999)
- `--password`: 设置访问密码

### 2. 访问应用

请在浏览器中访问：
👉 `http://localhost:28999`

## 🛠️ 开源致谢

本项目使用了以下优秀的开源项目：

*   **UI 图标**: [Font Awesome](https://fontawesome.com/) (CC BY 4.0 / OFL)
*   **色彩算法**: [ColorThief](https://lokeshdhakar.com/projects/color-thief/) (MIT)
*   **歌词/封面 API**: [LrcApi](https://github.com/HisAtri/LrcApi) (GPL-3.0)
*   **网易云 API**: [NeteaseCloudMusicApiEnhanced](https://github.com/NeteaseCloudMusicApiEnhanced/api-enhanced) (MIT)
*   **企鹅 API**: [QQMusicApi](https://github.com/L-1124/QQMusicApi) (MIT)

## 🚀 重要说明
本项目是由2FMusic衍生版本，已修改部分代码，如有冒犯可联系作者
*   **2FMusic**: [yuexps](https://github.com/yuexps/2FMusic) 

##  项目更改内容

*   **🎧 本地音乐库**
    *   添加定位歌曲按钮
    *   添加可以添加到我的歌单
*   **📱 我的歌单**
    *   可以创建歌单列表
*   **📂 灵活目录管理**
    *   支持添加服务器上的任意文件夹到音乐库，无需重复移动文件。
    *   修改下载歌曲/歌曲封面/歌词到用户设置的挂载目录（没设置，默认目录）
    *   以挂载目录添加重新扫描，避免没获取最新数据（一般下载后就会自动刷新）
*   **☁️ QQ音乐集成**
    *   集成搜索、高品质下载功能。
    *   支持链接解析及扫码登录/Cooke登录，轻松同步歌单。（手机验证码没适配，暂不可用）
    *   QQ音乐服务是内嵌的，和网易云服务不一样（主要不会弄，能力有限）

##  更新日志
*  歌单导入后的歌曲顺序和QQ的歌曲顺序一样
*  我的歌单列表标题添加播放全部

*  多用户系统已完成
*  密码即用户身份（6位以上，必须包含字母和数字）
*  每个用户的数据存储在 user_data/ 目录下的独立 JSON 文件中
*  管理员是启动时通过 --password 参数设置的密码
*  开放注册，任何人都可以注册
*  管理员可以看到所有功能（目录管理、上传音乐、设置、退出登录）
*  普通用户只能看到：本地音乐、我的收藏、我的歌单、网易下载、QQ音乐、退出登录(普通用户退出)
*  普通用户的网易云和QQ音乐页面不再显示用户账户/登录按钮(有管理员提供账号)

*  进入 QQ 音乐页面时，自动加载热门推荐歌曲
*  CGI代理预览401认证问题
*  移动端歌曲卡片按钮位置
*  QQ歌单导入包含待下载歌曲（pending_songs）
*  移动端QQ搜索框位置和播放列表删除按钮样式
*  下载源对话框标签页切换问题
*  播放列表歌曲排序和展开状态保持
*  添加cryptography依赖支持QIMEI生成
